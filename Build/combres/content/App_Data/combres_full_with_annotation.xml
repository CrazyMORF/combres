<?xml version="1.0" encoding="utf-8" ?>
<combres xmlns='urn:combres'>

  <!-- FILTERS (optional)
    * Declare filter types, including custom filters
    * For each filter, specify its fully qualified type name
    * Checkout the documentation of each filter to know what it does
  -->
  <filters>
    <!--
      acceptedResourceSets (optional): semicolon-separated list of resource set names.  
      * If specified: the filter is applied to only the selected resource sets
      * If not specified: the filter is applied to all resource sets
    -->
    <filter type="Combres.Filters.FixUrlsInCssFilter, Combres" acceptedResourceSets="siteCss" />
    <filter type="Combres.Filters.HandleCssVariablesFilter, Combres" />
    <filter type="Combres.Filters.DotLessCssFilter, Combres" />
  </filters>

  <!-- CACHE VARY PROVIDERS (optional)
    * See ICacheVaryProvider for more information
  -->
  <cacheVaryProviders>
    <provider type="LanguageCacheVaryProvider, SampleCommon.LanguageCacheVaryProvider">
      <param name="SessionKey" type="string" value="language" />
    </provider>
    <provider type="Provider2, Assembly2" acceptedResourceSets="siteCss" />
  </cacheVaryProviders>
  
  <!-- CSS MINIFIERS (optional)
    * Declare CSS minifier types, including custom minifiers
    * For each minifier, specify its fully qualified type name
    * Checkout the documentation of each minifier to know the properties it supports
  -->
  <cssMinifiers>
    <minifier name="yui" type="Combres.Minifiers.YuiCssMinifier, Combres">
      <param name="RemoveComments" type="bool" value="true" />
      <param name="LineBreakPosition" type="int" value="-1" />
    </minifier>
    <minifier name="msajax" type="Combres.Minifiers.MSAjaxCssMinifier, Combres">
      <param name="OutputMode" type="string" value="SingleLine" />
      <param name="MinifyExpressions" type="bool" value="true" />
    </minifier>
  </cssMinifiers>
  
  <!-- JS MINIFIERS (optional)
    * Declare JS minifier types, including custom minifiers
    * For each minifier, specify its fully qualified type name
    * Checkout the documentation of each minifier to know the properties it supports
  -->  
  <jsMinifiers>
    <minifier name="yui" type="Combres.Minifiers.YuiJSMinifier, Combres">
      <param name="IsVerboseLogging" type="bool" value="false" />
      <param name="ObfuscateJavascript" type="bool" value="true" />
      <param name="PreserveAllSemicolons" type="bool" value="false" />
      <param name="DisableOptimizations" type="bool" value="false" />
      <param name="IgnoreEval" type="bool" value="true" />
      <param name="LineBreakPosition" type="int" value="-1" />
    </minifier>
    <minifier name="msajax" type="Combres.Minifiers.MSAjaxJSMinifier, Combres">
      <param name="EvalTreatment" type="string" value="MakeAllSafe" />
      <param name="MacSafariQuirks" type="bool" value="true" />
      <param name="LocalRenaming" type="string" value="CrunchAll" />
      <param name="OutputMode" type="string" value="SingleLine" />
      <param name="RemoveUnneededCode" type="bool" value="true" />
      <param name="StripDebugStatements" type="bool" value="true" />
    </minifier>
    <minifier name="closure" type="Combres.Minifiers.ClosureJSMinifier, Combres">
      <param name="ApiUrl" type="string" value="http://closure-compiler.appspot.com/compile" />
      <param name="CompilationLevel" type="string" value="ADVANCED_OPTIMIZATIONS" />
    </minifier>
    <!-- 
      To use this minifier, make sure:
      * The machine running Combres has the JRE installed
      * Copy the Closure compiler (compiler.jar) into the bin folder of your application 
    -->
    <minifier name="local-closure" type="Combres.Minifiers.LocalClosureJSMinifier, Combres">
      <param name="JavaExePath" type="string" value="" />
      <param name="CompilationLevel" type="string" value="BASIC_OPTIMIZATIONS" />
    </minifier>
  </jsMinifiers>

  <!-- RESOURCE SETS (required)
    Note: all settings with 'default' prefix can be overriden by specific resource set.

    * url (required): route to serve all  Combres resource sets, e.g. /combres.axd
    * host (optional): the host from which all resource sets are requested. If not specified, it's the application host. This setting is useful when deploying with CDNs. See http://combres.codeplex.com/discussions/235498 for more details.
    * sslHost (optional): the host to be used instead of 'host' if Request.IsSecureConnection is true.
    * defaultDuration (optional): the number of days to cache in browser and server.
    * defaultVersion (optional): the version
      If 'auto': version is automatically generated by Combres based on the followings:
      - Contents of all resources in the set
      - All filters applied to the set
      - The currently selected minifier
      Note: in auto versioning mode, Combres automatically detects changes and re-computes the version
    * defaultVersionGenerator (optional): a fully-qualified type name of a version generator used to generate version if 'auto' mode is on. There are 2 built-in generators:
      - Combres.VersionGenerators.DefaultVersionGenerator (used by default)
      - Combres.VersionGenerators.Sha512VersionGenerator
    * defaultDebugEnabled (optional - default is 'false'):
      - true/false (false is default): if true, Combres will not cache or minify contents
      - 'auto': use web.config's debugging status
    * defaultIgnorePipelineWhenDebug (optional - default is 'false'): if this is true and debugEnabled is turned on, Combres will generate script and link tags corresponding to each resource in the set without any preprocessing whatsoever.
    * defaultCompressionEnabled (optional - default is 'true'): control whether Combres should compress contents or not. Should be 'false' if you rely on IIS or any server compression.
    * defaultCssMinifierRef (optional - default is 'default'): 
      - Name of the default CSS minifier for resource sets
      - If 'off': not perform any minification
      - If 'default': use the Combres' default minifier with default configurations
      - Otherwise: must be a valid minifier defined in the <cssMinifiers> section
   * defaultJSMinifierRef (optional - default is 'default'): 
      - Name of the default JS minifier for resource sets
      - If 'off': not perform any minification
      - If 'default': use the Combres' default minifier with default configurations
      - Otherwise: must be a valid minifier defined in the <jsMinifiers> section
   * localChangeMonitorInterval (optional): interval in seconds that Combres will check for changes in local dynamic resources. If not specified or if value is '' or '0', monitoring is disabled.
   * remoteChangeMonitorInterval (optional): same as localChangeMonitorInterval but for remote dynamic resources.
  -->
  <resourceSets url="~/combres.axd" 
                host="http://www.site.com"
                sslHost="https://secure.site.com"
                localChangeMonitorInterval="30"
                remoteChangeMonitorInterval="120"
                defaultDuration="30" 
                defaultVersion="1"
                defaultVersionGenerator="Combres.VersionGenerators.Sha512VersionGenerator"
                defaultCssMinifierRef="off" 
                defaultJSMinifierRef="off"
                defaultDebugEnabled="auto"
                defaultIgnorePipelineWhenDebug="true"
                defaultCompressionEnabled="true"
                >

    <!-- CSS RESOURCE SET (optional)
      * A group of CSS resources which are to be served in a single HTTP request.
      * name (required): the unique name of this resource set
      * type (required): 'css'
      * version (optional): see resourceSets#defaultVersion
      * versionGenerator (optional): see resourceSets#defaultVersionGenerator
      * duration (optional): see resourceSets#defaultDuration  
      * debugEnabled (optional): see resourceSets#defaultDebugEnabled 
      * ignorePipelineWhenDebug (optional): see resourceSets#defaultIgnorePipelineWhenDebug
      * compressionEnabled (optional): see resourceSets#defaultCompressionEnabled
      * minifierRef (optional): see resourceSets#defaultCssMinifierRef or defaultJSMinifierRef
    -->
    <resourceSet name="siteCss" 
                 type="css" 
                 duration="15" 
                 minifierRef="yui" 
                 debugEnabled="false"
                 ignorePipelineWhenDebug="true"
                 compressionEnabled="true">
      
      <!-- RESOURCE (required)
        * path (required): partial URL (must start with ~/) if located in the same app or absolute URL if in another app or server
        * mode (optional): 'Static'|'Dynamic'
          - 'Static' (default): resource is served directly from the file system
          - 'Dynamic': resource is dynamic and should be requested via HTTP before serving
        * forwardCookie (optional): relay cookies to the destination URL (applicable to Dynamic resource only)
        * minifierRef (optional): if not specified, use resourceSet#minifierRef
        * reference (optional): a placeholder resource to represent all resources of another resource set, useful to share reference common resources in multiple sets
      -->
      <resource path="~/content/site.css" />
      <resource path="~/content/jquery-ui-1.7.2.custom.css" />
    </resourceSet>

    <!-- JS RESOURCE SET (optional)
      * A group of JS resources which are to be served in a single HTTP request.
      * name (required): the unique name of this resource set
      * type (required): 'js'
      * version (optional): see resourceSets#defaultVersion
      * versionGenerator (optional): see resourceSets#defaultVersionGenerator
      * duration (optional): see resourceSets#defaultDuration  
      * debugEnabled (optional): see resourceSets#defaultDebugEnabled 
      * ignorePipelineWhenDebug (optional): see resourceSets#defaultIgnorePipelineWhenDebug
      * compressionEnabled (optional): see resourceSets#defaultCompressionEnabled
      * minifierRef (optional): see resourceSets#defaultCssMinifierRef or defaultJSMinifierRef
    -->
    <resourceSet name="siteJs" type="js" version="10" minifierRef="msajax" debugEnabled="false">
      <resource path="http://ajax.googleapis.com/ajax/libs/jquery/1.3.2/jquery.js" mode="dynamic" forwardCookie="false" />
      <resource path="~/scripts/jquery-ui-1.7.2.custom.min.js" mode="static" minifierRef="yui" />
    </resourceSet>
  </resourceSets>
</combres>